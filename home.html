<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home - Lemoney</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.css"/>
    <script src="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.js.iife.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">

    <style>
        /* --- LOGO STYLES --- */
        .logo-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }
        .logo {
            max-width: 150px; 
            height: auto;
            cursor: pointer;
        }
/* Styles for Outter Edge*/ 
        .modal-input {
            width: 100%;
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <title>Home - Lemoney</title>
                <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.css"/>
                <script src="https://cdn.jsdelivr.net/npm/driver.js@1.0.1/dist/driver.js.iife.js"></script>
                <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
                <link rel="stylesheet" href="style.css">

                <style>
                    /* --- LOGO STYLES --- */
                    .logo-container {
                        display: flex;
                        justify-content: center;
                        margin-bottom: 20px;
                    }
                    .logo {
                        max-width: 150px; 
                        height: auto;
                        cursor: pointer;
                    }
            /* Styles for Outter Edge*/ 
                    .modal-input {
                        width: 100%;
                        padding: 10px 12px;
                        border-radius: 8px;
                        border: 1px solid #d0d0d0;
                        margin-bottom: 12px;
                        box-sizing: border-box;
                        font-size: 1rem;
                        }

                    /* --- LAYOUT CONTAINERS --- */
                    .dashboard-content {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        gap: 50px; 
                        max-width: 1000px;
                        margin: 0 auto;
                    }
                    /* Stats Row */
                    .stats-row {
                        display: flex;
                        gap: 30px;
                        width: 100%;
                        justify-content: space-between;
                    }
        
                    .stat-box {
                        flex: 1; 
                        background: #f9fafb;
                        padding: 20px;
                        border-radius: 12px;
                        text-align: left;
                        border: 1px solid #e5e5e5;
                    }
                    .stat-val { font-size: 1.8rem; font-weight: 800; display: block; }
                    .stat-label { font-size: 0.9rem; color: #6e6e73; }

                    /* Charts Row */
                    .charts-row {
                        display: flex;
                        gap: 40px;
                        width: 100%;
                        justify-content: center;
                        flex-wrap: wrap; 
                    }

                    .calendar-card, .chart-card {
                        background: #fff;
                        border: 1px solid #e5e5e5;
                        border-radius: 16px;
                        padding: 25px;
                        flex: 1;             
                        min-width: 300px;    
                        box-shadow: 0 4px 12px rgba(0,0,0,0.03);
                    }

                    /* --- CALENDAR SPECIFIC --- */
                    .calendar-header {
                        font-size: 1.2rem;
                        font-weight: 700;
                        margin-bottom: 20px;
                        text-align: left;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                    }

                    .calendar-grid {
                        display: grid;
                        grid-template-columns: repeat(7, 1fr);
                        gap: 8px;
                        text-align: center;
                    }

                    .weekday-label {
                        font-size: 0.8rem;
                        font-weight: 600;
                        color: #9aa0a6;
                        margin-bottom: 10px;
                    }

                    .day-cell {
                        height: 45px;
                        display: flex;
                        justify-content: center;
                        align-items: center;
                        border-radius: 10px;
                        font-size: 0.9rem;
                        position: relative;
                        background: #f9fafb;
                        color: #1a1a1a;
                    }

                    .status-icon { position: absolute; font-size: 1.1rem; }
                    .day-fire { background: #fff4e5; border: 1px solid #ffe0b2; color: transparent; }
                    .day-fire .status-icon { color: #ff9800; } 
                    .day-check { background: #e6f4ea; border: 1px solid #ceead6; color: transparent; }
                    .day-check .status-icon { color: #34a853; } 
                    .day-miss { background: #fce8e6; border: 1px solid #fad2cf; color: transparent; }
                    .day-miss .status-icon { color: #ea4335; } 
                    .current-day { border: 2px solid #1a1a1a; font-weight: 700; }

                    /* --- CHART SPECIFIC (FIXED) --- */
                    .chart-container {
                        display: flex;
                        justify-content: space-between;
                        height: 200px; 
                        padding-bottom: 5px;
                        border-bottom: 1px solid #e5e5e5;
                    }

                    .chart-column {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        width: 12%;
                        height: 100%; 
                        justify-content: flex-end; 
                    }

                    /* UPDATE: Changed background to green */
                    .chart-bar {
                        width: 100%;
                        background: #4CAF50; /* GREEN */
                        border-radius: 4px 4px 0 0;
                        transition: height 0.5s ease;
                        position: relative;
                        min-height: 2px;
                    }
        
                    .chart-bar:hover::after {
                        content: attr(data-points);
                        position: absolute;
                        top: -25px;
                        left: 50%;
                        transform: translateX(-50%);
                        background: #000;
                        color: #fff;
                        padding: 4px 6px;
                        border-radius: 4px;
                        font-size: 0.75rem;
                    }

                    .chart-day-label {
                        margin-top: 8px;
                        font-size: 0.75rem;
                        color: #6e6e73;
                    }

                    /* --- LOADING OVERLAY STYLES (ADDED) --- */
                    #loadingOverlay {
                        position: fixed;
                        top: 0;
                        left: 0;
                        width: 100%;
                        height: 100%;
                        background: #ffffff;
                        display: flex;
                        align-items: center;   /* vertical center */
                        justify-content: center; /* horizontal center */
                        text-align: center;
                        /* very high z-index to ensure overlay sits above everything */
                        z-index: 2147483647;
                        transition: opacity 0.4s ease;
                    }
                    #loadingOverlay.hidden { display: none; }
                        #loadingGif {
                            /* responsive base size then visually scale 3x */
                            max-width: min(1000px, 90vw);
                            max-height: 90vh;
                            width: auto;
                            height: auto;
                            display: block;
                            margin: 0 auto;
                            align-self: center;
                            transition: opacity 0.6s ease, transform 0.25s ease;
                            will-change: opacity, transform;
                            object-fit: contain;
                            transform-origin: center center;
                            transform: scale(6);
                            /* put GIF above overlay children and other elements */
                            position: relative;
                            z-index: 2147483648;
                        }
                    /* Dim the page brightness while overlay is showing/during fade */
                    .page-container.dimmed {
                        transition: filter 1.2s ease, opacity 3s ease;
                        filter: brightness(0.10);
                            opacity: 0.95;
                    }
                    body.no-scroll { overflow: hidden; }
                </style>
            </head>
            <body>

                <!-- LOADING OVERLAY (ADDED) -->
                <div id="loadingOverlay" aria-hidden="true">
                    <img id="loadingGif" src="Graphics/loading.gif" alt="Loading">
                </div>

                <div class="page-container">
        
                    <div class="logo-container">
                        <a href="home.html" title="Home">
                            <img src="Graphics/LEMONEY%20logo.png" alt="Lemoney logo" class="logo">
                        </a>
                    </div>

                    <nav class="nav-bar">
                        <a href="home.html" class="nav-link active">Home</a>
                        <a href="budget.html" class="nav-link">Budget</a>
                        <a href="task.html" class="nav-link">Task</a>
                        <a href="shop.html" class="nav-link">Shop</a>
                    </nav>

                    <div style="width:100%; display:flex; flex-direction:column; align-items:center; margin-top:12px; padding:20px; gap:20px;">
                        <img src="Graphics/welcomeback.png" style="margin:0 auto; display:block; cursor:pointer; text-align:center;" onclick="location.href='home.html'">
                        <p style="margin:0; color:#6e6e73; text-align:center;">Here is your activity for October.</p>
                    </div>
    
                    <div class="dashboard-content">

                        <div class="stats-row">
                            <div class="stat-box">
                                <span class="stat-val">12</span>
                                <span class="stat-label">Days Streak ðŸ”¥</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-val">450</span>
                                <span class="stat-label">Total Points</span>
                            </div>
                            <div class="stat-box">
                                <span class="stat-val">85%</span>
                                <span class="stat-label">Completion Rate</span>
                            </div>
                        </div>
            
                        <div class="charts-row">
                
                            <div class="calendar-card">
                                <div class="calendar-header">
                                    <span id="monthName">Month</span>
                                    <i class="fa-solid fa-calendar-days" style="color:#9aa0a6;"></i>
                                </div>
                                <div class="calendar-grid" id="calendarGrid"></div>
                            </div>

                            <div class="chart-card">
                                <div class="calendar-header">
                                    <span>Weekly Points</span>
                                    <i class="fa-solid fa-chart-simple" style="color:#9aa0a6;"></i>
                                </div>
                                <div class="chart-container" id="weeklyChart"></div>
                            </div>

                        </div>

                    </div>
                </div>

                <script>
                    // 1. SETUP DATE
                    const date = new Date();
                    const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                    document.getElementById('monthName').innerText = monthNames[date.getMonth()] + " " + date.getFullYear();

                    // 2. GENERATE CALENDAR
                    const calendarGrid = document.getElementById('calendarGrid');
                    const daysInCurrentMonth = new Date(date.getFullYear(), date.getMonth() + 1, 0).getDate();
                    const currentDay = date.getDate();

                    const weekdays = ['Su', 'Mo', 'Tu', 'We', 'Th', 'Fr', 'Sa'];
                    weekdays.forEach(day => {
                        const div = document.createElement('div');
                        div.className = 'weekday-label';
                        div.innerText = day;
                        calendarGrid.appendChild(div);
                    });

                    for (let i = 1; i <= daysInCurrentMonth; i++) {
                        const dayDiv = document.createElement('div');
                        dayDiv.className = 'day-cell';
                        dayDiv.innerText = i;

                        if (i < currentDay) {
                            const random = Math.random();
                            if (random > 0.6) {
                                dayDiv.classList.add('day-fire');
                                dayDiv.innerHTML = `<i class="fa-solid fa-fire status-icon"></i>`;
                            } else if (random > 0.3) {
                                dayDiv.classList.add('day-check');
                                dayDiv.innerHTML = `<i class="fa-solid fa-check status-icon"></i>`;
                            } else {
                                dayDiv.classList.add('day-miss');
                                dayDiv.innerHTML = `<i class="fa-solid fa-xmark status-icon"></i>`;
                            }
                        } else if (i === currentDay) {
                            dayDiv.classList.add('current-day');
                        }
                        calendarGrid.appendChild(dayDiv);
                    }

                    // 3. GENERATE WEEKLY CHART
                    const chartContainer = document.getElementById('weeklyChart');
        
                    const weeklyData = [
                        { day: 'Mon', points: 15 },
                        { day: 'Tue', points: 35 },
                        { day: 'Wed', points: 50 },
                        { day: 'Thu', points: 20 },
                        { day: 'Fri', points: 40 },
                        { day: 'Sat', points: 5 },
                        { day: 'Sun', points: 10 }
                    ];

                    const MAX_SCORE_SCALE = 50; 

                    weeklyData.forEach(data => {
                        const col = document.createElement('div');
                        col.className = 'chart-column';

                        let heightPercent = (data.points / MAX_SCORE_SCALE) * 100;
                        if (heightPercent > 100) heightPercent = 100;

                        col.innerHTML = `
                            <div class="chart-bar" style="height: ${heightPercent}%;" data-points="${data.points} pts"></div>
                            <span class="chart-day-label">${data.day}</span>
                        `;
                        chartContainer.appendChild(col);
                    });
                </script>

                <!-- LOADING CONTROL SCRIPT (ADDED) -->
                <script>
                    (function () {
                        const overlay = document.getElementById('loadingOverlay');
                        const loadingGif = document.getElementById('loadingGif');
                        const pageContainer = document.querySelector('.page-container');

                        // timings (ms)
                        const fadeDuration = 1000;      // fade lasts 1s (halved)
                        const totalVisible = 3000;      // total time overlay is visible (unchanged)
                        const fadeStart = Math.max(0, totalVisible - fadeDuration); // start fade so that fadeDuration ends at totalVisible

                        function showLoading() {
                            // show
                            overlay.style.display = 'flex';
                            overlay.style.opacity = '1';
                            loadingGif.style.opacity = '1';
                            pageContainer.classList.add('dimmed');
                            document.body.classList.add('no-scroll');

                            // start dimming / fade after fadeStart
                            setTimeout(() => {
                                // reduce page brightness (already dimmed by class) and fade the GIF over fadeDuration
                                loadingGif.style.opacity = '0.01';
                            }, fadeStart);

                            // hide overlay after totalVisible
                            setTimeout(() => {
                                overlay.style.display = 'none';
                                pageContainer.classList.remove('dimmed');
                                document.body.classList.remove('no-scroll');
                                // reset gif opacity for next time
                                loadingGif.style.opacity = '1';
                            }, totalVisible);
                        }

                        // Run on initial load
                        window.addEventListener('DOMContentLoaded', () => {
                            // Always show the loading overlay when opening home
                            showLoading();
                        });

                        // Also handle bfcache/back navigation where DOMContentLoaded may not fire
                        window.addEventListener('pageshow', (e) => {
                            // show when arriving to this page (including back-forward cache restores)
                            showLoading();
                        });

                        // Optional: if links bring user back to home via same-page nav, show overlay on click
                        document.querySelectorAll('a[href="home.html"]').forEach(a => {
                            a.addEventListener('click', () => {
                                // let the new page show overlay on load; ensure current shows it briefly too
                                showLoading();
                            });
                        });
                    })();
                </script>

                <script src="tour.js"></script>
            </body>
            </html>